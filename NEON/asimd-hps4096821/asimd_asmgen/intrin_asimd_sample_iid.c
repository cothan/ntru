#include "../../sample.h"
#include <arm_neon.h>

void sample_iid(poly *r, const unsigned char uniformbytes[NTRU_SAMPLE_IID_BYTES]){
 uint16x8_t y0, y1, y2, y3, y4, y5, y6; 
 int16x8_t y7, y8, y9, y10; 
 uint16x8_t y11, y12, y13, y14, y15; 
 y4 = vdupq_n_s16(0x3) ;
 y6 = vdupq_n_u16(0xff) ;
 y5 = vdupq_n_u16(0xf) ;
 y11 = vdupq_n_u16(0) ;
// 0 -> 16
 y0 = vld1q_u16 (0 + uniformbytes) ;
 y1 = vld1q_u16 (8 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (0 + r->coeffs, y2);
vst1q_u16 (8 + r->coeffs, y3);
// 16 -> 32
 y0 = vld1q_u16 (16 + uniformbytes) ;
 y1 = vld1q_u16 (24 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (16 + r->coeffs, y2);
vst1q_u16 (24 + r->coeffs, y3);
// 32 -> 48
 y0 = vld1q_u16 (32 + uniformbytes) ;
 y1 = vld1q_u16 (40 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (32 + r->coeffs, y2);
vst1q_u16 (40 + r->coeffs, y3);
// 48 -> 64
 y0 = vld1q_u16 (48 + uniformbytes) ;
 y1 = vld1q_u16 (56 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (48 + r->coeffs, y2);
vst1q_u16 (56 + r->coeffs, y3);
// 64 -> 80
 y0 = vld1q_u16 (64 + uniformbytes) ;
 y1 = vld1q_u16 (72 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (64 + r->coeffs, y2);
vst1q_u16 (72 + r->coeffs, y3);
// 80 -> 96
 y0 = vld1q_u16 (80 + uniformbytes) ;
 y1 = vld1q_u16 (88 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (80 + r->coeffs, y2);
vst1q_u16 (88 + r->coeffs, y3);
// 96 -> 112
 y0 = vld1q_u16 (96 + uniformbytes) ;
 y1 = vld1q_u16 (104 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (96 + r->coeffs, y2);
vst1q_u16 (104 + r->coeffs, y3);
// 112 -> 128
 y0 = vld1q_u16 (112 + uniformbytes) ;
 y1 = vld1q_u16 (120 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (112 + r->coeffs, y2);
vst1q_u16 (120 + r->coeffs, y3);
// 128 -> 144
 y0 = vld1q_u16 (128 + uniformbytes) ;
 y1 = vld1q_u16 (136 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (128 + r->coeffs, y2);
vst1q_u16 (136 + r->coeffs, y3);
// 144 -> 160
 y0 = vld1q_u16 (144 + uniformbytes) ;
 y1 = vld1q_u16 (152 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (144 + r->coeffs, y2);
vst1q_u16 (152 + r->coeffs, y3);
// 160 -> 176
 y0 = vld1q_u16 (160 + uniformbytes) ;
 y1 = vld1q_u16 (168 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (160 + r->coeffs, y2);
vst1q_u16 (168 + r->coeffs, y3);
// 176 -> 192
 y0 = vld1q_u16 (176 + uniformbytes) ;
 y1 = vld1q_u16 (184 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (176 + r->coeffs, y2);
vst1q_u16 (184 + r->coeffs, y3);
// 192 -> 208
 y0 = vld1q_u16 (192 + uniformbytes) ;
 y1 = vld1q_u16 (200 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (192 + r->coeffs, y2);
vst1q_u16 (200 + r->coeffs, y3);
// 208 -> 224
 y0 = vld1q_u16 (208 + uniformbytes) ;
 y1 = vld1q_u16 (216 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (208 + r->coeffs, y2);
vst1q_u16 (216 + r->coeffs, y3);
// 224 -> 240
 y0 = vld1q_u16 (224 + uniformbytes) ;
 y1 = vld1q_u16 (232 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (224 + r->coeffs, y2);
vst1q_u16 (232 + r->coeffs, y3);
// 240 -> 256
 y0 = vld1q_u16 (240 + uniformbytes) ;
 y1 = vld1q_u16 (248 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (240 + r->coeffs, y2);
vst1q_u16 (248 + r->coeffs, y3);
// 256 -> 272
 y0 = vld1q_u16 (256 + uniformbytes) ;
 y1 = vld1q_u16 (264 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (256 + r->coeffs, y2);
vst1q_u16 (264 + r->coeffs, y3);
// 272 -> 288
 y0 = vld1q_u16 (272 + uniformbytes) ;
 y1 = vld1q_u16 (280 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (272 + r->coeffs, y2);
vst1q_u16 (280 + r->coeffs, y3);
// 288 -> 304
 y0 = vld1q_u16 (288 + uniformbytes) ;
 y1 = vld1q_u16 (296 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (288 + r->coeffs, y2);
vst1q_u16 (296 + r->coeffs, y3);
// 304 -> 320
 y0 = vld1q_u16 (304 + uniformbytes) ;
 y1 = vld1q_u16 (312 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (304 + r->coeffs, y2);
vst1q_u16 (312 + r->coeffs, y3);
// 320 -> 336
 y0 = vld1q_u16 (320 + uniformbytes) ;
 y1 = vld1q_u16 (328 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (320 + r->coeffs, y2);
vst1q_u16 (328 + r->coeffs, y3);
// 336 -> 352
 y0 = vld1q_u16 (336 + uniformbytes) ;
 y1 = vld1q_u16 (344 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (336 + r->coeffs, y2);
vst1q_u16 (344 + r->coeffs, y3);
// 352 -> 368
 y0 = vld1q_u16 (352 + uniformbytes) ;
 y1 = vld1q_u16 (360 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (352 + r->coeffs, y2);
vst1q_u16 (360 + r->coeffs, y3);
// 368 -> 384
 y0 = vld1q_u16 (368 + uniformbytes) ;
 y1 = vld1q_u16 (376 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (368 + r->coeffs, y2);
vst1q_u16 (376 + r->coeffs, y3);
// 384 -> 400
 y0 = vld1q_u16 (384 + uniformbytes) ;
 y1 = vld1q_u16 (392 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (384 + r->coeffs, y2);
vst1q_u16 (392 + r->coeffs, y3);
// 400 -> 416
 y0 = vld1q_u16 (400 + uniformbytes) ;
 y1 = vld1q_u16 (408 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (400 + r->coeffs, y2);
vst1q_u16 (408 + r->coeffs, y3);
// 416 -> 432
 y0 = vld1q_u16 (416 + uniformbytes) ;
 y1 = vld1q_u16 (424 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (416 + r->coeffs, y2);
vst1q_u16 (424 + r->coeffs, y3);
// 432 -> 448
 y0 = vld1q_u16 (432 + uniformbytes) ;
 y1 = vld1q_u16 (440 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (432 + r->coeffs, y2);
vst1q_u16 (440 + r->coeffs, y3);
// 448 -> 464
 y0 = vld1q_u16 (448 + uniformbytes) ;
 y1 = vld1q_u16 (456 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (448 + r->coeffs, y2);
vst1q_u16 (456 + r->coeffs, y3);
// 464 -> 480
 y0 = vld1q_u16 (464 + uniformbytes) ;
 y1 = vld1q_u16 (472 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (464 + r->coeffs, y2);
vst1q_u16 (472 + r->coeffs, y3);
// 480 -> 496
 y0 = vld1q_u16 (480 + uniformbytes) ;
 y1 = vld1q_u16 (488 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (480 + r->coeffs, y2);
vst1q_u16 (488 + r->coeffs, y3);
// 496 -> 512
 y0 = vld1q_u16 (496 + uniformbytes) ;
 y1 = vld1q_u16 (504 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (496 + r->coeffs, y2);
vst1q_u16 (504 + r->coeffs, y3);
// 512 -> 528
 y0 = vld1q_u16 (512 + uniformbytes) ;
 y1 = vld1q_u16 (520 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (512 + r->coeffs, y2);
vst1q_u16 (520 + r->coeffs, y3);
// 528 -> 544
 y0 = vld1q_u16 (528 + uniformbytes) ;
 y1 = vld1q_u16 (536 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (528 + r->coeffs, y2);
vst1q_u16 (536 + r->coeffs, y3);
// 544 -> 560
 y0 = vld1q_u16 (544 + uniformbytes) ;
 y1 = vld1q_u16 (552 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (544 + r->coeffs, y2);
vst1q_u16 (552 + r->coeffs, y3);
// 560 -> 576
 y0 = vld1q_u16 (560 + uniformbytes) ;
 y1 = vld1q_u16 (568 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (560 + r->coeffs, y2);
vst1q_u16 (568 + r->coeffs, y3);
// 576 -> 592
 y0 = vld1q_u16 (576 + uniformbytes) ;
 y1 = vld1q_u16 (584 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (576 + r->coeffs, y2);
vst1q_u16 (584 + r->coeffs, y3);
// 592 -> 608
 y0 = vld1q_u16 (592 + uniformbytes) ;
 y1 = vld1q_u16 (600 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (592 + r->coeffs, y2);
vst1q_u16 (600 + r->coeffs, y3);
// 608 -> 624
 y0 = vld1q_u16 (608 + uniformbytes) ;
 y1 = vld1q_u16 (616 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (608 + r->coeffs, y2);
vst1q_u16 (616 + r->coeffs, y3);
// 624 -> 640
 y0 = vld1q_u16 (624 + uniformbytes) ;
 y1 = vld1q_u16 (632 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (624 + r->coeffs, y2);
vst1q_u16 (632 + r->coeffs, y3);
// 640 -> 656
 y0 = vld1q_u16 (640 + uniformbytes) ;
 y1 = vld1q_u16 (648 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (640 + r->coeffs, y2);
vst1q_u16 (648 + r->coeffs, y3);
// 656 -> 672
 y0 = vld1q_u16 (656 + uniformbytes) ;
 y1 = vld1q_u16 (664 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (656 + r->coeffs, y2);
vst1q_u16 (664 + r->coeffs, y3);
// 672 -> 688
 y0 = vld1q_u16 (672 + uniformbytes) ;
 y1 = vld1q_u16 (680 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (672 + r->coeffs, y2);
vst1q_u16 (680 + r->coeffs, y3);
// 688 -> 704
 y0 = vld1q_u16 (688 + uniformbytes) ;
 y1 = vld1q_u16 (696 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (688 + r->coeffs, y2);
vst1q_u16 (696 + r->coeffs, y3);
// 704 -> 720
 y0 = vld1q_u16 (704 + uniformbytes) ;
 y1 = vld1q_u16 (712 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (704 + r->coeffs, y2);
vst1q_u16 (712 + r->coeffs, y3);
// 720 -> 736
 y0 = vld1q_u16 (720 + uniformbytes) ;
 y1 = vld1q_u16 (728 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (720 + r->coeffs, y2);
vst1q_u16 (728 + r->coeffs, y3);
// 736 -> 752
 y0 = vld1q_u16 (736 + uniformbytes) ;
 y1 = vld1q_u16 (744 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (736 + r->coeffs, y2);
vst1q_u16 (744 + r->coeffs, y3);
// 752 -> 768
 y0 = vld1q_u16 (752 + uniformbytes) ;
 y1 = vld1q_u16 (760 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (752 + r->coeffs, y2);
vst1q_u16 (760 + r->coeffs, y3);
// 768 -> 784
 y0 = vld1q_u16 (768 + uniformbytes) ;
 y1 = vld1q_u16 (776 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (768 + r->coeffs, y2);
vst1q_u16 (776 + r->coeffs, y3);
// 784 -> 800
 y0 = vld1q_u16 (784 + uniformbytes) ;
 y1 = vld1q_u16 (792 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (784 + r->coeffs, y2);
vst1q_u16 (792 + r->coeffs, y3);
// 800 -> 816
 y0 = vld1q_u16 (800 + uniformbytes) ;
 y1 = vld1q_u16 (808 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y3 = vshrq_n_u16 (y1, 8) ;
 y1 = vandq_u16 (y1, y6) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 4) ;
 y3 = vandq_u16 (y3, y5) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y1 = vshrq_n_u16 (y3, 2) ;
 y3 = vandq_u16 (y3, (uint16x8_t) y4) ;
 y3 = vaddq_u16 (y1, y3) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y8 = vsubq_s16 ( (int16x8_t) y3, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y10 = vshrq_n_s16 (y8, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
 y1 = vandq_u16 ( (uint16x8_t) y10, y3) ;
 y10 = vmvnq_s16 (y10) ;
 y8 = vandq_s16 (y10, y8) ;
 y3 = veorq_u16 (y1, (uint16x8_t) y8) ;
// DONE MOD3 
vst1q_u16 (800 + r->coeffs, y2);
vst1q_u16 (808 + r->coeffs, y3);
// 816 -> 832
 y0 = vld1q_u16 (816 + uniformbytes) ;
// MOD3 
 y2 = vshrq_n_u16 (y0, 8) ;
 y0 = vandq_u16 (y0, y6) ;
 y2 = vaddq_u16 (y0, y2) ;
 y0 = vshrq_n_u16 (y2, 4) ;
 y2 = vandq_u16 (y2, y5) ;
 y2 = vaddq_u16 (y0, y2) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y0 = vshrq_n_u16 (y2, 2) ;
 y2 = vandq_u16 (y2, (uint16x8_t) y4) ;
 y2 = vaddq_u16 (y0, y2) ;
 y7 = vsubq_s16 ( (int16x8_t) y2, y4) ;
 y9 = vshrq_n_s16 (y7, 15) ;
 y0 = vandq_u16 ( (uint16x8_t) y9, y2) ;
 y9 = vmvnq_s16 (y9) ;
 y7 = vandq_s16 (y9, y7) ;
 y2 = veorq_u16 (y0, (uint16x8_t) y7) ;
// DONE MOD3 
vst1q_u16 (816 + r->coeffs, y2);
vst1q_u16 (824 + r->coeffs, y11);
 r->coeffs[820] = 0 ;
 r->coeffs[821] = 0 ;
 r->coeffs[822] = 0 ;
 r->coeffs[823] = 0 ;
}
