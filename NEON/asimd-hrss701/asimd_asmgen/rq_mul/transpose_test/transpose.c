#include <arm_neon.h>
#include <stdio.h>

#define SIZE 96*16
#define SIZE2 48*16

int main()
{
	uint16x8_t y0, y1, y2, y3, y4, y5, y6, y7, y8, y9, y10, y11, y12, y13, y14, y15, y16, y17, y18, y19, y20, y21, y22, y23, y24, y25, y26, y27, y28, y29, y30, y31, y32, y33, y34, y35;
	uint16_t in[SIZE] ={0}; 
    uint16_t out[SIZE] ={0}; 
	for (uint16_t i = 0; i < SIZE; i++)
	{
		in[i] = i;
	}
for (uint16_t i = 0; i < SIZE2; i++)
	{
		if (i % 16 == 0)
		printf("\n");

		printf("%4d ", in[i]);
	}

// -------------- n = 0
// 16x16: LD A1
y0 = vld1q_u16(in + 0);
y1 = vld1q_u16(in + 16);
y2 = vld1q_u16(in + 32);
y3 = vld1q_u16(in + 48);
y4 = vld1q_u16(in + 64);
y5 = vld1q_u16(in + 80);
y6 = vld1q_u16(in + 96);
y7 = vld1q_u16(in + 112);
// Transpose 8x8
y16 = vtrn1q_u16(y0, y1);
y17 = vtrn2q_u16(y0, y1);
y18 = vtrn1q_u16(y2, y3);
y19 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y16, y17);
y25 = vtrn2q_u32(y16, y17);
y26 = vtrn1q_u32(y18, y19);
y27 = vtrn2q_u32(y18, y19);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u16(y4, y5);
y17 = vtrn2q_u16(y4, y5);
y18 = vtrn1q_u16(y6, y7);
y19 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y16, y17);
y25 = vtrn2q_u32(y16, y17);
y26 = vtrn1q_u32(y18, y19);
y27 = vtrn2q_u32(y18, y19);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u64(y8, y12);
y17 = vtrn2q_u64(y8, y12);
y18 = vtrn1q_u64(y10, y14);
y19 = vtrn2q_u64(y10, y14);
y20 = vtrn1q_u64(y9, y13);
y21 = vtrn2q_u64(y9, y13);
y22 = vtrn1q_u64(y11, y15);
y23 = vtrn2q_u64(y11, y15);
// 16x16: STR A1
vst1q_u16(out + 0, y16);
vst1q_u16(out + 96, y18);
vst1q_u16(out + 192, y20);
vst1q_u16(out + 288, y22);
vst1q_u16(out + 384, y17);
vst1q_u16(out + 480, y19);
vst1q_u16(out + 576, y21);
vst1q_u16(out + 672, y23);
// 16x16: LD A4
y0 = vld1q_u16(in + 136);
y1 = vld1q_u16(in + 152);
y2 = vld1q_u16(in + 168);
y3 = vld1q_u16(in + 184);
y4 = vld1q_u16(in + 200);
y5 = vld1q_u16(in + 216);
y6 = vld1q_u16(in + 232);
y7 = vld1q_u16(in + 248);
// Transpose 8x8
y16 = vtrn1q_u16(y0, y1);
y18 = vtrn2q_u16(y0, y1);
y20 = vtrn1q_u16(y2, y3);
y22 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y16, y18);
y25 = vtrn2q_u32(y16, y18);
y26 = vtrn1q_u32(y20, y22);
y27 = vtrn2q_u32(y20, y22);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u16(y4, y5);
y18 = vtrn2q_u16(y4, y5);
y20 = vtrn1q_u16(y6, y7);
y22 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y16, y18);
y25 = vtrn2q_u32(y16, y18);
y26 = vtrn1q_u32(y20, y22);
y27 = vtrn2q_u32(y20, y22);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u64(y8, y12);
y18 = vtrn2q_u64(y8, y12);
y20 = vtrn1q_u64(y10, y14);
y22 = vtrn2q_u64(y10, y14);
y17 = vtrn1q_u64(y9, y13);
y19 = vtrn2q_u64(y9, y13);
y21 = vtrn1q_u64(y11, y15);
y23 = vtrn2q_u64(y11, y15);
// 16x16: STR A4
vst1q_u16(out + 776, y16);
vst1q_u16(out + 872, y20);
vst1q_u16(out + 968, y17);
vst1q_u16(out + 1064, y21);
vst1q_u16(out + 1160, y18);
vst1q_u16(out + 1256, y22);
vst1q_u16(out + 1352, y19);
vst1q_u16(out + 1448, y23);
// 16x16: LD A2
y0 = vld1q_u16(in + 8);
y1 = vld1q_u16(in + 24);
y2 = vld1q_u16(in + 40);
y3 = vld1q_u16(in + 56);
y4 = vld1q_u16(in + 72);
y5 = vld1q_u16(in + 88);
y6 = vld1q_u16(in + 104);
y7 = vld1q_u16(in + 120);
// Transpose 8x8
y16 = vtrn1q_u16(y0, y1);
y20 = vtrn2q_u16(y0, y1);
y17 = vtrn1q_u16(y2, y3);
y21 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y16, y20);
y25 = vtrn2q_u32(y16, y20);
y26 = vtrn1q_u32(y17, y21);
y27 = vtrn2q_u32(y17, y21);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u16(y4, y5);
y20 = vtrn2q_u16(y4, y5);
y17 = vtrn1q_u16(y6, y7);
y21 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y16, y20);
y25 = vtrn2q_u32(y16, y20);
y26 = vtrn1q_u32(y17, y21);
y27 = vtrn2q_u32(y17, y21);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u64(y8, y12);
y20 = vtrn2q_u64(y8, y12);
y17 = vtrn1q_u64(y10, y14);
y21 = vtrn2q_u64(y10, y14);
y18 = vtrn1q_u64(y9, y13);
y22 = vtrn2q_u64(y9, y13);
y19 = vtrn1q_u64(y11, y15);
y23 = vtrn2q_u64(y11, y15);
// 16x16: LD A3
y0 = vld1q_u16(in + 128);
y1 = vld1q_u16(in + 144);
y2 = vld1q_u16(in + 160);
y3 = vld1q_u16(in + 176);
y4 = vld1q_u16(in + 192);
y5 = vld1q_u16(in + 208);
y6 = vld1q_u16(in + 224);
y7 = vld1q_u16(in + 240);
// Transpose 8x8
y28 = vtrn1q_u16(y0, y1);
y29 = vtrn2q_u16(y0, y1);
y30 = vtrn1q_u16(y2, y3);
y31 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y28, y29);
y25 = vtrn2q_u32(y28, y29);
y26 = vtrn1q_u32(y30, y31);
y27 = vtrn2q_u32(y30, y31);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y28 = vtrn1q_u16(y4, y5);
y29 = vtrn2q_u16(y4, y5);
y30 = vtrn1q_u16(y6, y7);
y31 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y28, y29);
y25 = vtrn2q_u32(y28, y29);
y26 = vtrn1q_u32(y30, y31);
y27 = vtrn2q_u32(y30, y31);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y28 = vtrn1q_u64(y8, y12);
y29 = vtrn2q_u64(y8, y12);
y30 = vtrn1q_u64(y10, y14);
y31 = vtrn2q_u64(y10, y14);
y32 = vtrn1q_u64(y9, y13);
y33 = vtrn2q_u64(y9, y13);
y34 = vtrn1q_u64(y11, y15);
y35 = vtrn2q_u64(y11, y15);
// 16x16: STR A2<-A3
vst1q_u16(out + 8, y28);
vst1q_u16(out + 104, y30);
vst1q_u16(out + 200, y32);
vst1q_u16(out + 296, y34);
vst1q_u16(out + 392, y29);
vst1q_u16(out + 488, y31);
vst1q_u16(out + 584, y33);
vst1q_u16(out + 680, y35);
// 16x16: STR A3<-A2
vst1q_u16(out + 768, y16);
vst1q_u16(out + 864, y17);
vst1q_u16(out + 960, y18);
vst1q_u16(out + 1056, y19);
vst1q_u16(out + 1152, y20);
vst1q_u16(out + 1248, y21);
vst1q_u16(out + 1344, y22);
vst1q_u16(out + 1440, y23);
// -------------- n = 1
// 16x16: LD A1
y0 = vld1q_u16(in + 256);
y1 = vld1q_u16(in + 272);
y2 = vld1q_u16(in + 288);
y3 = vld1q_u16(in + 304);
y4 = vld1q_u16(in + 320);
y5 = vld1q_u16(in + 336);
y6 = vld1q_u16(in + 352);
y7 = vld1q_u16(in + 368);
// Transpose 8x8
y16 = vtrn1q_u16(y0, y1);
y17 = vtrn2q_u16(y0, y1);
y18 = vtrn1q_u16(y2, y3);
y19 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y16, y17);
y25 = vtrn2q_u32(y16, y17);
y26 = vtrn1q_u32(y18, y19);
y27 = vtrn2q_u32(y18, y19);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u16(y4, y5);
y17 = vtrn2q_u16(y4, y5);
y18 = vtrn1q_u16(y6, y7);
y19 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y16, y17);
y25 = vtrn2q_u32(y16, y17);
y26 = vtrn1q_u32(y18, y19);
y27 = vtrn2q_u32(y18, y19);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u64(y8, y12);
y17 = vtrn2q_u64(y8, y12);
y18 = vtrn1q_u64(y10, y14);
y19 = vtrn2q_u64(y10, y14);
y20 = vtrn1q_u64(y9, y13);
y21 = vtrn2q_u64(y9, y13);
y22 = vtrn1q_u64(y11, y15);
y23 = vtrn2q_u64(y11, y15);
// 16x16: STR A1
vst1q_u16(out + 16, y16);
vst1q_u16(out + 112, y18);
vst1q_u16(out + 208, y20);
vst1q_u16(out + 304, y22);
vst1q_u16(out + 400, y17);
vst1q_u16(out + 496, y19);
vst1q_u16(out + 592, y21);
vst1q_u16(out + 688, y23);
// 16x16: LD A4
y0 = vld1q_u16(in + 392);
y1 = vld1q_u16(in + 408);
y2 = vld1q_u16(in + 424);
y3 = vld1q_u16(in + 440);
y4 = vld1q_u16(in + 456);
y5 = vld1q_u16(in + 472);
y6 = vld1q_u16(in + 488);
y7 = vld1q_u16(in + 504);
// Transpose 8x8
y16 = vtrn1q_u16(y0, y1);
y18 = vtrn2q_u16(y0, y1);
y20 = vtrn1q_u16(y2, y3);
y22 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y16, y18);
y25 = vtrn2q_u32(y16, y18);
y26 = vtrn1q_u32(y20, y22);
y27 = vtrn2q_u32(y20, y22);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u16(y4, y5);
y18 = vtrn2q_u16(y4, y5);
y20 = vtrn1q_u16(y6, y7);
y22 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y16, y18);
y25 = vtrn2q_u32(y16, y18);
y26 = vtrn1q_u32(y20, y22);
y27 = vtrn2q_u32(y20, y22);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u64(y8, y12);
y18 = vtrn2q_u64(y8, y12);
y20 = vtrn1q_u64(y10, y14);
y22 = vtrn2q_u64(y10, y14);
y17 = vtrn1q_u64(y9, y13);
y19 = vtrn2q_u64(y9, y13);
y21 = vtrn1q_u64(y11, y15);
y23 = vtrn2q_u64(y11, y15);
// 16x16: STR A4
vst1q_u16(out + 792, y16);
vst1q_u16(out + 888, y20);
vst1q_u16(out + 984, y17);
vst1q_u16(out + 1080, y21);
vst1q_u16(out + 1176, y18);
vst1q_u16(out + 1272, y22);
vst1q_u16(out + 1368, y19);
vst1q_u16(out + 1464, y23);
// 16x16: LD A2
y0 = vld1q_u16(in + 264);
y1 = vld1q_u16(in + 280);
y2 = vld1q_u16(in + 296);
y3 = vld1q_u16(in + 312);
y4 = vld1q_u16(in + 328);
y5 = vld1q_u16(in + 344);
y6 = vld1q_u16(in + 360);
y7 = vld1q_u16(in + 376);
// Transpose 8x8
y16 = vtrn1q_u16(y0, y1);
y20 = vtrn2q_u16(y0, y1);
y17 = vtrn1q_u16(y2, y3);
y21 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y16, y20);
y25 = vtrn2q_u32(y16, y20);
y26 = vtrn1q_u32(y17, y21);
y27 = vtrn2q_u32(y17, y21);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u16(y4, y5);
y20 = vtrn2q_u16(y4, y5);
y17 = vtrn1q_u16(y6, y7);
y21 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y16, y20);
y25 = vtrn2q_u32(y16, y20);
y26 = vtrn1q_u32(y17, y21);
y27 = vtrn2q_u32(y17, y21);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u64(y8, y12);
y20 = vtrn2q_u64(y8, y12);
y17 = vtrn1q_u64(y10, y14);
y21 = vtrn2q_u64(y10, y14);
y18 = vtrn1q_u64(y9, y13);
y22 = vtrn2q_u64(y9, y13);
y19 = vtrn1q_u64(y11, y15);
y23 = vtrn2q_u64(y11, y15);
// 16x16: LD A3
y0 = vld1q_u16(in + 384);
y1 = vld1q_u16(in + 400);
y2 = vld1q_u16(in + 416);
y3 = vld1q_u16(in + 432);
y4 = vld1q_u16(in + 448);
y5 = vld1q_u16(in + 464);
y6 = vld1q_u16(in + 480);
y7 = vld1q_u16(in + 496);
// Transpose 8x8
y28 = vtrn1q_u16(y0, y1);
y29 = vtrn2q_u16(y0, y1);
y30 = vtrn1q_u16(y2, y3);
y31 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y28, y29);
y25 = vtrn2q_u32(y28, y29);
y26 = vtrn1q_u32(y30, y31);
y27 = vtrn2q_u32(y30, y31);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y28 = vtrn1q_u16(y4, y5);
y29 = vtrn2q_u16(y4, y5);
y30 = vtrn1q_u16(y6, y7);
y31 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y28, y29);
y25 = vtrn2q_u32(y28, y29);
y26 = vtrn1q_u32(y30, y31);
y27 = vtrn2q_u32(y30, y31);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y28 = vtrn1q_u64(y8, y12);
y29 = vtrn2q_u64(y8, y12);
y30 = vtrn1q_u64(y10, y14);
y31 = vtrn2q_u64(y10, y14);
y32 = vtrn1q_u64(y9, y13);
y33 = vtrn2q_u64(y9, y13);
y34 = vtrn1q_u64(y11, y15);
y35 = vtrn2q_u64(y11, y15);
// 16x16: STR A2<-A3
vst1q_u16(out + 24, y28);
vst1q_u16(out + 120, y30);
vst1q_u16(out + 216, y32);
vst1q_u16(out + 312, y34);
vst1q_u16(out + 408, y29);
vst1q_u16(out + 504, y31);
vst1q_u16(out + 600, y33);
vst1q_u16(out + 696, y35);
// 16x16: STR A3<-A2
vst1q_u16(out + 784, y16);
vst1q_u16(out + 880, y17);
vst1q_u16(out + 976, y18);
vst1q_u16(out + 1072, y19);
vst1q_u16(out + 1168, y20);
vst1q_u16(out + 1264, y21);
vst1q_u16(out + 1360, y22);
vst1q_u16(out + 1456, y23);
// -------------- n = 2
// 16x16: LD A1
y0 = vld1q_u16(in + 512);
y1 = vld1q_u16(in + 528);
y2 = vld1q_u16(in + 544);
y3 = vld1q_u16(in + 560);
y4 = vld1q_u16(in + 576);
y5 = vld1q_u16(in + 592);
y6 = vld1q_u16(in + 608);
y7 = vld1q_u16(in + 624);
// Transpose 8x8
y16 = vtrn1q_u16(y0, y1);
y17 = vtrn2q_u16(y0, y1);
y18 = vtrn1q_u16(y2, y3);
y19 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y16, y17);
y25 = vtrn2q_u32(y16, y17);
y26 = vtrn1q_u32(y18, y19);
y27 = vtrn2q_u32(y18, y19);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u16(y4, y5);
y17 = vtrn2q_u16(y4, y5);
y18 = vtrn1q_u16(y6, y7);
y19 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y16, y17);
y25 = vtrn2q_u32(y16, y17);
y26 = vtrn1q_u32(y18, y19);
y27 = vtrn2q_u32(y18, y19);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u64(y8, y12);
y17 = vtrn2q_u64(y8, y12);
y18 = vtrn1q_u64(y10, y14);
y19 = vtrn2q_u64(y10, y14);
y20 = vtrn1q_u64(y9, y13);
y21 = vtrn2q_u64(y9, y13);
y22 = vtrn1q_u64(y11, y15);
y23 = vtrn2q_u64(y11, y15);
// 16x16: STR A1
vst1q_u16(out + 32, y16);
vst1q_u16(out + 128, y18);
vst1q_u16(out + 224, y20);
vst1q_u16(out + 320, y22);
vst1q_u16(out + 416, y17);
vst1q_u16(out + 512, y19);
vst1q_u16(out + 608, y21);
vst1q_u16(out + 704, y23);
// 16x16: LD A4
y0 = vld1q_u16(in + 648);
y1 = vld1q_u16(in + 664);
y2 = vld1q_u16(in + 680);
y3 = vld1q_u16(in + 696);
y4 = vld1q_u16(in + 712);
y5 = vld1q_u16(in + 728);
y6 = vld1q_u16(in + 744);
y7 = vld1q_u16(in + 760);
// Transpose 8x8
y16 = vtrn1q_u16(y0, y1);
y18 = vtrn2q_u16(y0, y1);
y20 = vtrn1q_u16(y2, y3);
y22 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y16, y18);
y25 = vtrn2q_u32(y16, y18);
y26 = vtrn1q_u32(y20, y22);
y27 = vtrn2q_u32(y20, y22);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u16(y4, y5);
y18 = vtrn2q_u16(y4, y5);
y20 = vtrn1q_u16(y6, y7);
y22 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y16, y18);
y25 = vtrn2q_u32(y16, y18);
y26 = vtrn1q_u32(y20, y22);
y27 = vtrn2q_u32(y20, y22);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u64(y8, y12);
y18 = vtrn2q_u64(y8, y12);
y20 = vtrn1q_u64(y10, y14);
y22 = vtrn2q_u64(y10, y14);
y17 = vtrn1q_u64(y9, y13);
y19 = vtrn2q_u64(y9, y13);
y21 = vtrn1q_u64(y11, y15);
y23 = vtrn2q_u64(y11, y15);
// 16x16: STR A4
vst1q_u16(out + 808, y16);
vst1q_u16(out + 904, y20);
vst1q_u16(out + 1000, y17);
vst1q_u16(out + 1096, y21);
vst1q_u16(out + 1192, y18);
vst1q_u16(out + 1288, y22);
vst1q_u16(out + 1384, y19);
vst1q_u16(out + 1480, y23);
// 16x16: LD A2
y0 = vld1q_u16(in + 520);
y1 = vld1q_u16(in + 536);
y2 = vld1q_u16(in + 552);
y3 = vld1q_u16(in + 568);
y4 = vld1q_u16(in + 584);
y5 = vld1q_u16(in + 600);
y6 = vld1q_u16(in + 616);
y7 = vld1q_u16(in + 632);
// Transpose 8x8
y16 = vtrn1q_u16(y0, y1);
y20 = vtrn2q_u16(y0, y1);
y17 = vtrn1q_u16(y2, y3);
y21 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y16, y20);
y25 = vtrn2q_u32(y16, y20);
y26 = vtrn1q_u32(y17, y21);
y27 = vtrn2q_u32(y17, y21);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u16(y4, y5);
y20 = vtrn2q_u16(y4, y5);
y17 = vtrn1q_u16(y6, y7);
y21 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y16, y20);
y25 = vtrn2q_u32(y16, y20);
y26 = vtrn1q_u32(y17, y21);
y27 = vtrn2q_u32(y17, y21);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u64(y8, y12);
y20 = vtrn2q_u64(y8, y12);
y17 = vtrn1q_u64(y10, y14);
y21 = vtrn2q_u64(y10, y14);
y18 = vtrn1q_u64(y9, y13);
y22 = vtrn2q_u64(y9, y13);
y19 = vtrn1q_u64(y11, y15);
y23 = vtrn2q_u64(y11, y15);
// 16x16: LD A3
y0 = vld1q_u16(in + 640);
y1 = vld1q_u16(in + 656);
y2 = vld1q_u16(in + 672);
y3 = vld1q_u16(in + 688);
y4 = vld1q_u16(in + 704);
y5 = vld1q_u16(in + 720);
y6 = vld1q_u16(in + 736);
y7 = vld1q_u16(in + 752);
// Transpose 8x8
y28 = vtrn1q_u16(y0, y1);
y29 = vtrn2q_u16(y0, y1);
y30 = vtrn1q_u16(y2, y3);
y31 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y28, y29);
y25 = vtrn2q_u32(y28, y29);
y26 = vtrn1q_u32(y30, y31);
y27 = vtrn2q_u32(y30, y31);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y28 = vtrn1q_u16(y4, y5);
y29 = vtrn2q_u16(y4, y5);
y30 = vtrn1q_u16(y6, y7);
y31 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y28, y29);
y25 = vtrn2q_u32(y28, y29);
y26 = vtrn1q_u32(y30, y31);
y27 = vtrn2q_u32(y30, y31);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y28 = vtrn1q_u64(y8, y12);
y29 = vtrn2q_u64(y8, y12);
y30 = vtrn1q_u64(y10, y14);
y31 = vtrn2q_u64(y10, y14);
y32 = vtrn1q_u64(y9, y13);
y33 = vtrn2q_u64(y9, y13);
y34 = vtrn1q_u64(y11, y15);
y35 = vtrn2q_u64(y11, y15);
// 16x16: STR A2<-A3
vst1q_u16(out + 40, y28);
vst1q_u16(out + 136, y30);
vst1q_u16(out + 232, y32);
vst1q_u16(out + 328, y34);
vst1q_u16(out + 424, y29);
vst1q_u16(out + 520, y31);
vst1q_u16(out + 616, y33);
vst1q_u16(out + 712, y35);
// 16x16: STR A3<-A2
vst1q_u16(out + 800, y16);
vst1q_u16(out + 896, y17);
vst1q_u16(out + 992, y18);
vst1q_u16(out + 1088, y19);
vst1q_u16(out + 1184, y20);
vst1q_u16(out + 1280, y21);
vst1q_u16(out + 1376, y22);
vst1q_u16(out + 1472, y23);
// -------------- n = 3
// 16x16: LD A1
y0 = vld1q_u16(in + 704);
y1 = vld1q_u16(in + 720);
y2 = vld1q_u16(in + 736);
y3 = vld1q_u16(in + 752);
y4 = vld1q_u16(in + 768);
y5 = vld1q_u16(in + 784);
y6 = vld1q_u16(in + 800);
y7 = vld1q_u16(in + 816);
// Transpose 8x8
y16 = vtrn1q_u16(y0, y1);
y17 = vtrn2q_u16(y0, y1);
y18 = vtrn1q_u16(y2, y3);
y19 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y16, y17);
y25 = vtrn2q_u32(y16, y17);
y26 = vtrn1q_u32(y18, y19);
y27 = vtrn2q_u32(y18, y19);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u16(y4, y5);
y17 = vtrn2q_u16(y4, y5);
y18 = vtrn1q_u16(y6, y7);
y19 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y16, y17);
y25 = vtrn2q_u32(y16, y17);
y26 = vtrn1q_u32(y18, y19);
y27 = vtrn2q_u32(y18, y19);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u64(y8, y12);
y17 = vtrn2q_u64(y8, y12);
y18 = vtrn1q_u64(y10, y14);
y19 = vtrn2q_u64(y10, y14);
y20 = vtrn1q_u64(y9, y13);
y21 = vtrn2q_u64(y9, y13);
y22 = vtrn1q_u64(y11, y15);
y23 = vtrn2q_u64(y11, y15);
// 16x16: STR A1
vst1q_u16(out + 48, y16);
vst1q_u16(out + 144, y18);
vst1q_u16(out + 240, y20);
vst1q_u16(out + 336, y22);
vst1q_u16(out + 432, y17);
vst1q_u16(out + 528, y19);
vst1q_u16(out + 624, y21);
vst1q_u16(out + 720, y23);
// 16x16: LD A4
y0 = vld1q_u16(in + 840);
y1 = vld1q_u16(in + 856);
y2 = vld1q_u16(in + 872);
y3 = vld1q_u16(in + 888);
y4 = vld1q_u16(in + 904);
y5 = vld1q_u16(in + 920);
y6 = vld1q_u16(in + 936);
y7 = vld1q_u16(in + 952);
// Transpose 8x8
y16 = vtrn1q_u16(y0, y1);
y18 = vtrn2q_u16(y0, y1);
y20 = vtrn1q_u16(y2, y3);
y22 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y16, y18);
y25 = vtrn2q_u32(y16, y18);
y26 = vtrn1q_u32(y20, y22);
y27 = vtrn2q_u32(y20, y22);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u16(y4, y5);
y18 = vtrn2q_u16(y4, y5);
y20 = vtrn1q_u16(y6, y7);
y22 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y16, y18);
y25 = vtrn2q_u32(y16, y18);
y26 = vtrn1q_u32(y20, y22);
y27 = vtrn2q_u32(y20, y22);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u64(y8, y12);
y18 = vtrn2q_u64(y8, y12);
y20 = vtrn1q_u64(y10, y14);
y22 = vtrn2q_u64(y10, y14);
y17 = vtrn1q_u64(y9, y13);
y19 = vtrn2q_u64(y9, y13);
y21 = vtrn1q_u64(y11, y15);
y23 = vtrn2q_u64(y11, y15);
// 16x16: STR A4
vst1q_u16(out + 824, y16);
vst1q_u16(out + 920, y20);
vst1q_u16(out + 1016, y17);
vst1q_u16(out + 1112, y21);
vst1q_u16(out + 1208, y18);
vst1q_u16(out + 1304, y22);
vst1q_u16(out + 1400, y19);
vst1q_u16(out + 1496, y23);
// 16x16: LD A2
y0 = vld1q_u16(in + 712);
y1 = vld1q_u16(in + 728);
y2 = vld1q_u16(in + 744);
y3 = vld1q_u16(in + 760);
y4 = vld1q_u16(in + 776);
y5 = vld1q_u16(in + 792);
y6 = vld1q_u16(in + 808);
y7 = vld1q_u16(in + 824);
// Transpose 8x8
y16 = vtrn1q_u16(y0, y1);
y20 = vtrn2q_u16(y0, y1);
y17 = vtrn1q_u16(y2, y3);
y21 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y16, y20);
y25 = vtrn2q_u32(y16, y20);
y26 = vtrn1q_u32(y17, y21);
y27 = vtrn2q_u32(y17, y21);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u16(y4, y5);
y20 = vtrn2q_u16(y4, y5);
y17 = vtrn1q_u16(y6, y7);
y21 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y16, y20);
y25 = vtrn2q_u32(y16, y20);
y26 = vtrn1q_u32(y17, y21);
y27 = vtrn2q_u32(y17, y21);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u64(y8, y12);
y20 = vtrn2q_u64(y8, y12);
y17 = vtrn1q_u64(y10, y14);
y21 = vtrn2q_u64(y10, y14);
y18 = vtrn1q_u64(y9, y13);
y22 = vtrn2q_u64(y9, y13);
y19 = vtrn1q_u64(y11, y15);
y23 = vtrn2q_u64(y11, y15);
// 16x16: LD A3
y0 = vld1q_u16(in + 832);
y1 = vld1q_u16(in + 848);
y2 = vld1q_u16(in + 864);
y3 = vld1q_u16(in + 880);
y4 = vld1q_u16(in + 896);
y5 = vld1q_u16(in + 912);
y6 = vld1q_u16(in + 928);
y7 = vld1q_u16(in + 944);
// Transpose 8x8
y28 = vtrn1q_u16(y0, y1);
y29 = vtrn2q_u16(y0, y1);
y30 = vtrn1q_u16(y2, y3);
y31 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y28, y29);
y25 = vtrn2q_u32(y28, y29);
y26 = vtrn1q_u32(y30, y31);
y27 = vtrn2q_u32(y30, y31);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y28 = vtrn1q_u16(y4, y5);
y29 = vtrn2q_u16(y4, y5);
y30 = vtrn1q_u16(y6, y7);
y31 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y28, y29);
y25 = vtrn2q_u32(y28, y29);
y26 = vtrn1q_u32(y30, y31);
y27 = vtrn2q_u32(y30, y31);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y28 = vtrn1q_u64(y8, y12);
y29 = vtrn2q_u64(y8, y12);
y30 = vtrn1q_u64(y10, y14);
y31 = vtrn2q_u64(y10, y14);
y32 = vtrn1q_u64(y9, y13);
y33 = vtrn2q_u64(y9, y13);
y34 = vtrn1q_u64(y11, y15);
y35 = vtrn2q_u64(y11, y15);
// 16x16: STR A2<-A3
vst1q_u16(out + 56, y28);
vst1q_u16(out + 152, y30);
vst1q_u16(out + 248, y32);
vst1q_u16(out + 344, y34);
vst1q_u16(out + 440, y29);
vst1q_u16(out + 536, y31);
vst1q_u16(out + 632, y33);
vst1q_u16(out + 728, y35);
// 16x16: STR A3<-A2
vst1q_u16(out + 816, y16);
vst1q_u16(out + 912, y17);
vst1q_u16(out + 1008, y18);
vst1q_u16(out + 1104, y19);
vst1q_u16(out + 1200, y20);
vst1q_u16(out + 1296, y21);
vst1q_u16(out + 1392, y22);
vst1q_u16(out + 1488, y23);
// -------------- n = 4
// 16x16: LD A1
y0 = vld1q_u16(in + 960);
y1 = vld1q_u16(in + 976);
y2 = vld1q_u16(in + 992);
y3 = vld1q_u16(in + 1008);
y4 = vld1q_u16(in + 1024);
y5 = vld1q_u16(in + 1040);
y6 = vld1q_u16(in + 1056);
y7 = vld1q_u16(in + 1072);
// Transpose 8x8
y16 = vtrn1q_u16(y0, y1);
y17 = vtrn2q_u16(y0, y1);
y18 = vtrn1q_u16(y2, y3);
y19 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y16, y17);
y25 = vtrn2q_u32(y16, y17);
y26 = vtrn1q_u32(y18, y19);
y27 = vtrn2q_u32(y18, y19);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u16(y4, y5);
y17 = vtrn2q_u16(y4, y5);
y18 = vtrn1q_u16(y6, y7);
y19 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y16, y17);
y25 = vtrn2q_u32(y16, y17);
y26 = vtrn1q_u32(y18, y19);
y27 = vtrn2q_u32(y18, y19);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u64(y8, y12);
y17 = vtrn2q_u64(y8, y12);
y18 = vtrn1q_u64(y10, y14);
y19 = vtrn2q_u64(y10, y14);
y20 = vtrn1q_u64(y9, y13);
y21 = vtrn2q_u64(y9, y13);
y22 = vtrn1q_u64(y11, y15);
y23 = vtrn2q_u64(y11, y15);
// 16x16: STR A1
vst1q_u16(out + 64, y16);
vst1q_u16(out + 160, y18);
vst1q_u16(out + 256, y20);
vst1q_u16(out + 352, y22);
vst1q_u16(out + 448, y17);
vst1q_u16(out + 544, y19);
vst1q_u16(out + 640, y21);
vst1q_u16(out + 736, y23);
// 16x16: LD A4
y0 = vld1q_u16(in + 1096);
y1 = vld1q_u16(in + 1112);
y2 = vld1q_u16(in + 1128);
y3 = vld1q_u16(in + 1144);
y4 = vld1q_u16(in + 1160);
y5 = vld1q_u16(in + 1176);
y6 = vld1q_u16(in + 1192);
y7 = vld1q_u16(in + 1208);
// Transpose 8x8
y16 = vtrn1q_u16(y0, y1);
y18 = vtrn2q_u16(y0, y1);
y20 = vtrn1q_u16(y2, y3);
y22 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y16, y18);
y25 = vtrn2q_u32(y16, y18);
y26 = vtrn1q_u32(y20, y22);
y27 = vtrn2q_u32(y20, y22);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u16(y4, y5);
y18 = vtrn2q_u16(y4, y5);
y20 = vtrn1q_u16(y6, y7);
y22 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y16, y18);
y25 = vtrn2q_u32(y16, y18);
y26 = vtrn1q_u32(y20, y22);
y27 = vtrn2q_u32(y20, y22);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u64(y8, y12);
y18 = vtrn2q_u64(y8, y12);
y20 = vtrn1q_u64(y10, y14);
y22 = vtrn2q_u64(y10, y14);
y17 = vtrn1q_u64(y9, y13);
y19 = vtrn2q_u64(y9, y13);
y21 = vtrn1q_u64(y11, y15);
y23 = vtrn2q_u64(y11, y15);
// 16x16: STR A4
vst1q_u16(out + 840, y16);
vst1q_u16(out + 936, y20);
vst1q_u16(out + 1032, y17);
vst1q_u16(out + 1128, y21);
vst1q_u16(out + 1224, y18);
vst1q_u16(out + 1320, y22);
vst1q_u16(out + 1416, y19);
vst1q_u16(out + 1512, y23);
// 16x16: LD A2
y0 = vld1q_u16(in + 968);
y1 = vld1q_u16(in + 984);
y2 = vld1q_u16(in + 1000);
y3 = vld1q_u16(in + 1016);
y4 = vld1q_u16(in + 1032);
y5 = vld1q_u16(in + 1048);
y6 = vld1q_u16(in + 1064);
y7 = vld1q_u16(in + 1080);
// Transpose 8x8
y16 = vtrn1q_u16(y0, y1);
y20 = vtrn2q_u16(y0, y1);
y17 = vtrn1q_u16(y2, y3);
y21 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y16, y20);
y25 = vtrn2q_u32(y16, y20);
y26 = vtrn1q_u32(y17, y21);
y27 = vtrn2q_u32(y17, y21);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u16(y4, y5);
y20 = vtrn2q_u16(y4, y5);
y17 = vtrn1q_u16(y6, y7);
y21 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y16, y20);
y25 = vtrn2q_u32(y16, y20);
y26 = vtrn1q_u32(y17, y21);
y27 = vtrn2q_u32(y17, y21);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u64(y8, y12);
y20 = vtrn2q_u64(y8, y12);
y17 = vtrn1q_u64(y10, y14);
y21 = vtrn2q_u64(y10, y14);
y18 = vtrn1q_u64(y9, y13);
y22 = vtrn2q_u64(y9, y13);
y19 = vtrn1q_u64(y11, y15);
y23 = vtrn2q_u64(y11, y15);
// 16x16: LD A3
y0 = vld1q_u16(in + 1088);
y1 = vld1q_u16(in + 1104);
y2 = vld1q_u16(in + 1120);
y3 = vld1q_u16(in + 1136);
y4 = vld1q_u16(in + 1152);
y5 = vld1q_u16(in + 1168);
y6 = vld1q_u16(in + 1184);
y7 = vld1q_u16(in + 1200);
// Transpose 8x8
y28 = vtrn1q_u16(y0, y1);
y29 = vtrn2q_u16(y0, y1);
y30 = vtrn1q_u16(y2, y3);
y31 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y28, y29);
y25 = vtrn2q_u32(y28, y29);
y26 = vtrn1q_u32(y30, y31);
y27 = vtrn2q_u32(y30, y31);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y28 = vtrn1q_u16(y4, y5);
y29 = vtrn2q_u16(y4, y5);
y30 = vtrn1q_u16(y6, y7);
y31 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y28, y29);
y25 = vtrn2q_u32(y28, y29);
y26 = vtrn1q_u32(y30, y31);
y27 = vtrn2q_u32(y30, y31);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y28 = vtrn1q_u64(y8, y12);
y29 = vtrn2q_u64(y8, y12);
y30 = vtrn1q_u64(y10, y14);
y31 = vtrn2q_u64(y10, y14);
y32 = vtrn1q_u64(y9, y13);
y33 = vtrn2q_u64(y9, y13);
y34 = vtrn1q_u64(y11, y15);
y35 = vtrn2q_u64(y11, y15);
// 16x16: STR A2<-A3
vst1q_u16(out + 72, y28);
vst1q_u16(out + 168, y30);
vst1q_u16(out + 264, y32);
vst1q_u16(out + 360, y34);
vst1q_u16(out + 456, y29);
vst1q_u16(out + 552, y31);
vst1q_u16(out + 648, y33);
vst1q_u16(out + 744, y35);
// 16x16: STR A3<-A2
vst1q_u16(out + 832, y16);
vst1q_u16(out + 928, y17);
vst1q_u16(out + 1024, y18);
vst1q_u16(out + 1120, y19);
vst1q_u16(out + 1216, y20);
vst1q_u16(out + 1312, y21);
vst1q_u16(out + 1408, y22);
vst1q_u16(out + 1504, y23);
// -------------- n = 5
// 16x16: LD A1
y0 = vld1q_u16(in + 1216);
y1 = vld1q_u16(in + 1232);
y2 = vld1q_u16(in + 1248);
y3 = vld1q_u16(in + 1264);
y4 = vld1q_u16(in + 1280);
y5 = vld1q_u16(in + 1296);
y6 = vld1q_u16(in + 1312);
y7 = vld1q_u16(in + 1328);
// Transpose 8x8
y16 = vtrn1q_u16(y0, y1);
y17 = vtrn2q_u16(y0, y1);
y18 = vtrn1q_u16(y2, y3);
y19 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y16, y17);
y25 = vtrn2q_u32(y16, y17);
y26 = vtrn1q_u32(y18, y19);
y27 = vtrn2q_u32(y18, y19);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u16(y4, y5);
y17 = vtrn2q_u16(y4, y5);
y18 = vtrn1q_u16(y6, y7);
y19 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y16, y17);
y25 = vtrn2q_u32(y16, y17);
y26 = vtrn1q_u32(y18, y19);
y27 = vtrn2q_u32(y18, y19);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u64(y8, y12);
y17 = vtrn2q_u64(y8, y12);
y18 = vtrn1q_u64(y10, y14);
y19 = vtrn2q_u64(y10, y14);
y20 = vtrn1q_u64(y9, y13);
y21 = vtrn2q_u64(y9, y13);
y22 = vtrn1q_u64(y11, y15);
y23 = vtrn2q_u64(y11, y15);
// 16x16: STR A1
vst1q_u16(out + 80, y16);
vst1q_u16(out + 176, y18);
vst1q_u16(out + 272, y20);
vst1q_u16(out + 368, y22);
vst1q_u16(out + 464, y17);
vst1q_u16(out + 560, y19);
vst1q_u16(out + 656, y21);
vst1q_u16(out + 752, y23);
// 16x16: LD A4
y0 = vld1q_u16(in + 1352);
y1 = vld1q_u16(in + 1368);
y2 = vld1q_u16(in + 1384);
y3 = vld1q_u16(in + 1400);
y4 = vld1q_u16(in + 1416);
y5 = vld1q_u16(in + 1432);
y6 = vld1q_u16(in + 1448);
y7 = vld1q_u16(in + 1464);
// Transpose 8x8
y16 = vtrn1q_u16(y0, y1);
y18 = vtrn2q_u16(y0, y1);
y20 = vtrn1q_u16(y2, y3);
y22 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y16, y18);
y25 = vtrn2q_u32(y16, y18);
y26 = vtrn1q_u32(y20, y22);
y27 = vtrn2q_u32(y20, y22);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u16(y4, y5);
y18 = vtrn2q_u16(y4, y5);
y20 = vtrn1q_u16(y6, y7);
y22 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y16, y18);
y25 = vtrn2q_u32(y16, y18);
y26 = vtrn1q_u32(y20, y22);
y27 = vtrn2q_u32(y20, y22);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u64(y8, y12);
y18 = vtrn2q_u64(y8, y12);
y20 = vtrn1q_u64(y10, y14);
y22 = vtrn2q_u64(y10, y14);
y17 = vtrn1q_u64(y9, y13);
y19 = vtrn2q_u64(y9, y13);
y21 = vtrn1q_u64(y11, y15);
y23 = vtrn2q_u64(y11, y15);
// 16x16: STR A4
vst1q_u16(out + 856, y16);
vst1q_u16(out + 952, y20);
vst1q_u16(out + 1048, y17);
vst1q_u16(out + 1144, y21);
vst1q_u16(out + 1240, y18);
vst1q_u16(out + 1336, y22);
vst1q_u16(out + 1432, y19);
vst1q_u16(out + 1528, y23);
// 16x16: LD A2
y0 = vld1q_u16(in + 1224);
y1 = vld1q_u16(in + 1240);
y2 = vld1q_u16(in + 1256);
y3 = vld1q_u16(in + 1272);
y4 = vld1q_u16(in + 1288);
y5 = vld1q_u16(in + 1304);
y6 = vld1q_u16(in + 1320);
y7 = vld1q_u16(in + 1336);
// Transpose 8x8
y16 = vtrn1q_u16(y0, y1);
y20 = vtrn2q_u16(y0, y1);
y17 = vtrn1q_u16(y2, y3);
y21 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y16, y20);
y25 = vtrn2q_u32(y16, y20);
y26 = vtrn1q_u32(y17, y21);
y27 = vtrn2q_u32(y17, y21);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u16(y4, y5);
y20 = vtrn2q_u16(y4, y5);
y17 = vtrn1q_u16(y6, y7);
y21 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y16, y20);
y25 = vtrn2q_u32(y16, y20);
y26 = vtrn1q_u32(y17, y21);
y27 = vtrn2q_u32(y17, y21);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y16 = vtrn1q_u64(y8, y12);
y20 = vtrn2q_u64(y8, y12);
y17 = vtrn1q_u64(y10, y14);
y21 = vtrn2q_u64(y10, y14);
y18 = vtrn1q_u64(y9, y13);
y22 = vtrn2q_u64(y9, y13);
y19 = vtrn1q_u64(y11, y15);
y23 = vtrn2q_u64(y11, y15);
// 16x16: LD A3
y0 = vld1q_u16(in + 1344);
y1 = vld1q_u16(in + 1360);
y2 = vld1q_u16(in + 1376);
y3 = vld1q_u16(in + 1392);
y4 = vld1q_u16(in + 1408);
y5 = vld1q_u16(in + 1424);
y6 = vld1q_u16(in + 1440);
y7 = vld1q_u16(in + 1456);
// Transpose 8x8
y28 = vtrn1q_u16(y0, y1);
y29 = vtrn2q_u16(y0, y1);
y30 = vtrn1q_u16(y2, y3);
y31 = vtrn2q_u16(y2, y3);
y24 = vtrn1q_u32(y28, y29);
y25 = vtrn2q_u32(y28, y29);
y26 = vtrn1q_u32(y30, y31);
y27 = vtrn2q_u32(y30, y31);
y8 = vtrn1q_u32(y24, y26);
y10 = vtrn2q_u32(y24, y26);
y9 = vtrn1q_u32(y25, y27);
y11 = vtrn2q_u32(y25, y27);
y28 = vtrn1q_u16(y4, y5);
y29 = vtrn2q_u16(y4, y5);
y30 = vtrn1q_u16(y6, y7);
y31 = vtrn2q_u16(y6, y7);
y24 = vtrn1q_u32(y28, y29);
y25 = vtrn2q_u32(y28, y29);
y26 = vtrn1q_u32(y30, y31);
y27 = vtrn2q_u32(y30, y31);
y12 = vtrn1q_u32(y24, y26);
y14 = vtrn2q_u32(y24, y26);
y13 = vtrn1q_u32(y25, y27);
y15 = vtrn2q_u32(y25, y27);
y28 = vtrn1q_u64(y8, y12);
y29 = vtrn2q_u64(y8, y12);
y30 = vtrn1q_u64(y10, y14);
y31 = vtrn2q_u64(y10, y14);
y32 = vtrn1q_u64(y9, y13);
y33 = vtrn2q_u64(y9, y13);
y34 = vtrn1q_u64(y11, y15);
y35 = vtrn2q_u64(y11, y15);
// 16x16: STR A2<-A3
vst1q_u16(out + 88, y28);
vst1q_u16(out + 184, y30);
vst1q_u16(out + 280, y32);
vst1q_u16(out + 376, y34);
vst1q_u16(out + 472, y29);
vst1q_u16(out + 568, y31);
vst1q_u16(out + 664, y33);
vst1q_u16(out + 760, y35);
// 16x16: STR A3<-A2
vst1q_u16(out + 848, y16);
vst1q_u16(out + 944, y17);
vst1q_u16(out + 1040, y18);
vst1q_u16(out + 1136, y19);
vst1q_u16(out + 1232, y20);
vst1q_u16(out + 1328, y21);
vst1q_u16(out + 1424, y22);
vst1q_u16(out + 1520, y23);

printf("\n=======================\n");

for (uint16_t i = 0; i < SIZE; i++)
	{
		if (i % 96 == 0)
		printf("\n");

        if (i % 16 == 0)
        printf(" | ");

		printf("%4d ", out[i]);
	}
printf("\n=======================\n");
}

