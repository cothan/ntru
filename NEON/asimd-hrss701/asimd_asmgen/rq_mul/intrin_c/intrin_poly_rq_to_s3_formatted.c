#include "../../poly.h"
#include <arm_neon.h>

void poly_Rq_to_S3(poly *r, const poly *a) {
  uint16x8_t y0, y1, y2, y3;
  int16x8_t y4, y5, y6, y7, y16;
  uint16x8_t y8, y9, y10, y11, y12, y13, y14, y15;
  y15 = vdupq_n_s16(0x0);
  y8 = vdupq_n_u16(0x3);
  y16 = vdupq_n_s16(0x3);
  y10 = vdupq_n_u16(0x1fff);
  y13 = vdupq_n_u16(0xff);
  y14 = vdupq_n_u16(0xf);
  // Find Last
  y9 = vld1q_u16(696 + a->coeffs);
  y9 = vandq_u16(y10, y9);
  y0 = vshrq_n_u16(y9, 12);
  y0 = veorq_u16(y8, y0);
  y0 = vshlq_n_u16(y0, 13);
  y0 = vaddq_u16(y0, y9);
  y9 = vdupq_laneq_u16(y9, 5);
  y9 = vshlq_n_u16(y9, 1);
  // Done Find Last
  // 0 -> 16
  y2 = vld1q_u16(0 + a->coeffs);
  y3 = vld1q_u16(8 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(0 + r->coeffs, y11);
  vst1q_u16(8 + r->coeffs, y12);
  // 16 -> 32
  y2 = vld1q_u16(16 + a->coeffs);
  y3 = vld1q_u16(24 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(16 + r->coeffs, y11);
  vst1q_u16(24 + r->coeffs, y12);
  // 32 -> 48
  y2 = vld1q_u16(32 + a->coeffs);
  y3 = vld1q_u16(40 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(32 + r->coeffs, y11);
  vst1q_u16(40 + r->coeffs, y12);
  // 48 -> 64
  y2 = vld1q_u16(48 + a->coeffs);
  y3 = vld1q_u16(56 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(48 + r->coeffs, y11);
  vst1q_u16(56 + r->coeffs, y12);
  // 64 -> 80
  y2 = vld1q_u16(64 + a->coeffs);
  y3 = vld1q_u16(72 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(64 + r->coeffs, y11);
  vst1q_u16(72 + r->coeffs, y12);
  // 80 -> 96
  y2 = vld1q_u16(80 + a->coeffs);
  y3 = vld1q_u16(88 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(80 + r->coeffs, y11);
  vst1q_u16(88 + r->coeffs, y12);
  // 96 -> 112
  y2 = vld1q_u16(96 + a->coeffs);
  y3 = vld1q_u16(104 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(96 + r->coeffs, y11);
  vst1q_u16(104 + r->coeffs, y12);
  // 112 -> 128
  y2 = vld1q_u16(112 + a->coeffs);
  y3 = vld1q_u16(120 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(112 + r->coeffs, y11);
  vst1q_u16(120 + r->coeffs, y12);
  // 128 -> 144
  y2 = vld1q_u16(128 + a->coeffs);
  y3 = vld1q_u16(136 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(128 + r->coeffs, y11);
  vst1q_u16(136 + r->coeffs, y12);
  // 144 -> 160
  y2 = vld1q_u16(144 + a->coeffs);
  y3 = vld1q_u16(152 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(144 + r->coeffs, y11);
  vst1q_u16(152 + r->coeffs, y12);
  // 160 -> 176
  y2 = vld1q_u16(160 + a->coeffs);
  y3 = vld1q_u16(168 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(160 + r->coeffs, y11);
  vst1q_u16(168 + r->coeffs, y12);
  // 176 -> 192
  y2 = vld1q_u16(176 + a->coeffs);
  y3 = vld1q_u16(184 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(176 + r->coeffs, y11);
  vst1q_u16(184 + r->coeffs, y12);
  // 192 -> 208
  y2 = vld1q_u16(192 + a->coeffs);
  y3 = vld1q_u16(200 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(192 + r->coeffs, y11);
  vst1q_u16(200 + r->coeffs, y12);
  // 208 -> 224
  y2 = vld1q_u16(208 + a->coeffs);
  y3 = vld1q_u16(216 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(208 + r->coeffs, y11);
  vst1q_u16(216 + r->coeffs, y12);
  // 224 -> 240
  y2 = vld1q_u16(224 + a->coeffs);
  y3 = vld1q_u16(232 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(224 + r->coeffs, y11);
  vst1q_u16(232 + r->coeffs, y12);
  // 240 -> 256
  y2 = vld1q_u16(240 + a->coeffs);
  y3 = vld1q_u16(248 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(240 + r->coeffs, y11);
  vst1q_u16(248 + r->coeffs, y12);
  // 256 -> 272
  y2 = vld1q_u16(256 + a->coeffs);
  y3 = vld1q_u16(264 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(256 + r->coeffs, y11);
  vst1q_u16(264 + r->coeffs, y12);
  // 272 -> 288
  y2 = vld1q_u16(272 + a->coeffs);
  y3 = vld1q_u16(280 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(272 + r->coeffs, y11);
  vst1q_u16(280 + r->coeffs, y12);
  // 288 -> 304
  y2 = vld1q_u16(288 + a->coeffs);
  y3 = vld1q_u16(296 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(288 + r->coeffs, y11);
  vst1q_u16(296 + r->coeffs, y12);
  // 304 -> 320
  y2 = vld1q_u16(304 + a->coeffs);
  y3 = vld1q_u16(312 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(304 + r->coeffs, y11);
  vst1q_u16(312 + r->coeffs, y12);
  // 320 -> 336
  y2 = vld1q_u16(320 + a->coeffs);
  y3 = vld1q_u16(328 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(320 + r->coeffs, y11);
  vst1q_u16(328 + r->coeffs, y12);
  // 336 -> 352
  y2 = vld1q_u16(336 + a->coeffs);
  y3 = vld1q_u16(344 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(336 + r->coeffs, y11);
  vst1q_u16(344 + r->coeffs, y12);
  // 352 -> 368
  y2 = vld1q_u16(352 + a->coeffs);
  y3 = vld1q_u16(360 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(352 + r->coeffs, y11);
  vst1q_u16(360 + r->coeffs, y12);
  // 368 -> 384
  y2 = vld1q_u16(368 + a->coeffs);
  y3 = vld1q_u16(376 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(368 + r->coeffs, y11);
  vst1q_u16(376 + r->coeffs, y12);
  // 384 -> 400
  y2 = vld1q_u16(384 + a->coeffs);
  y3 = vld1q_u16(392 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(384 + r->coeffs, y11);
  vst1q_u16(392 + r->coeffs, y12);
  // 400 -> 416
  y2 = vld1q_u16(400 + a->coeffs);
  y3 = vld1q_u16(408 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(400 + r->coeffs, y11);
  vst1q_u16(408 + r->coeffs, y12);
  // 416 -> 432
  y2 = vld1q_u16(416 + a->coeffs);
  y3 = vld1q_u16(424 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(416 + r->coeffs, y11);
  vst1q_u16(424 + r->coeffs, y12);
  // 432 -> 448
  y2 = vld1q_u16(432 + a->coeffs);
  y3 = vld1q_u16(440 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(432 + r->coeffs, y11);
  vst1q_u16(440 + r->coeffs, y12);
  // 448 -> 464
  y2 = vld1q_u16(448 + a->coeffs);
  y3 = vld1q_u16(456 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(448 + r->coeffs, y11);
  vst1q_u16(456 + r->coeffs, y12);
  // 464 -> 480
  y2 = vld1q_u16(464 + a->coeffs);
  y3 = vld1q_u16(472 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(464 + r->coeffs, y11);
  vst1q_u16(472 + r->coeffs, y12);
  // 480 -> 496
  y2 = vld1q_u16(480 + a->coeffs);
  y3 = vld1q_u16(488 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(480 + r->coeffs, y11);
  vst1q_u16(488 + r->coeffs, y12);
  // 496 -> 512
  y2 = vld1q_u16(496 + a->coeffs);
  y3 = vld1q_u16(504 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(496 + r->coeffs, y11);
  vst1q_u16(504 + r->coeffs, y12);
  // 512 -> 528
  y2 = vld1q_u16(512 + a->coeffs);
  y3 = vld1q_u16(520 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(512 + r->coeffs, y11);
  vst1q_u16(520 + r->coeffs, y12);
  // 528 -> 544
  y2 = vld1q_u16(528 + a->coeffs);
  y3 = vld1q_u16(536 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(528 + r->coeffs, y11);
  vst1q_u16(536 + r->coeffs, y12);
  // 544 -> 560
  y2 = vld1q_u16(544 + a->coeffs);
  y3 = vld1q_u16(552 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(544 + r->coeffs, y11);
  vst1q_u16(552 + r->coeffs, y12);
  // 560 -> 576
  y2 = vld1q_u16(560 + a->coeffs);
  y3 = vld1q_u16(568 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(560 + r->coeffs, y11);
  vst1q_u16(568 + r->coeffs, y12);
  // 576 -> 592
  y2 = vld1q_u16(576 + a->coeffs);
  y3 = vld1q_u16(584 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(576 + r->coeffs, y11);
  vst1q_u16(584 + r->coeffs, y12);
  // 592 -> 608
  y2 = vld1q_u16(592 + a->coeffs);
  y3 = vld1q_u16(600 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(592 + r->coeffs, y11);
  vst1q_u16(600 + r->coeffs, y12);
  // 608 -> 624
  y2 = vld1q_u16(608 + a->coeffs);
  y3 = vld1q_u16(616 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(608 + r->coeffs, y11);
  vst1q_u16(616 + r->coeffs, y12);
  // 624 -> 640
  y2 = vld1q_u16(624 + a->coeffs);
  y3 = vld1q_u16(632 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(624 + r->coeffs, y11);
  vst1q_u16(632 + r->coeffs, y12);
  // 640 -> 656
  y2 = vld1q_u16(640 + a->coeffs);
  y3 = vld1q_u16(648 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(640 + r->coeffs, y11);
  vst1q_u16(648 + r->coeffs, y12);
  // 656 -> 672
  y2 = vld1q_u16(656 + a->coeffs);
  y3 = vld1q_u16(664 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(656 + r->coeffs, y11);
  vst1q_u16(664 + r->coeffs, y12);
  // 672 -> 688
  y2 = vld1q_u16(672 + a->coeffs);
  y3 = vld1q_u16(680 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(672 + r->coeffs, y11);
  vst1q_u16(680 + r->coeffs, y12);
  // 688 -> 704
  y2 = vld1q_u16(688 + a->coeffs);
  y3 = vld1q_u16(696 + a->coeffs);
  y2 = vandq_u16(y10, y2);
  y3 = vandq_u16(y10, y3);
  y0 = vshrq_n_u16(y2, 12);
  y1 = vshrq_n_u16(y3, 12);
  y0 = veorq_u16(y8, y0);
  y1 = veorq_u16(y8, y1);
  y0 = vshlq_n_u16(y0, 13);
  y1 = vshlq_n_u16(y1, 13);
  y0 = vaddq_u16(y0, y2);
  y1 = vaddq_u16(y1, y3);
  y0 = vaddq_u16(y0, y9);
  y1 = vaddq_u16(y1, y9);
  // MOD3
  y11 = vshrq_n_u16(y0, 8);
  y0 = vandq_u16(y0, y13);
  y11 = vaddq_u16(y0, y11);
  y12 = vshrq_n_u16(y1, 8);
  y1 = vandq_u16(y1, y13);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 4);
  y11 = vandq_u16(y11, y14);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 4);
  y12 = vandq_u16(y12, y14);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y0 = vshrq_n_u16(y11, 2);
  y11 = vandq_u16(y11, y16);
  y11 = vaddq_u16(y0, y11);
  y1 = vshrq_n_u16(y12, 2);
  y12 = vandq_u16(y12, y16);
  y12 = vaddq_u16(y1, y12);
  y4 = vsubq_s16(y11, y16);
  y5 = vsubq_s16(y12, y16);
  y6 = vshrq_n_s16(y4, 15);
  y7 = vshrq_n_s16(y5, 15);
  y0 = vandq_u16(y6, y11);
  y6 = vmvnq_s16(y6);
  y4 = vandq_s16(y6, y4);
  y11 = veorq_u16(y0, y4);
  y1 = vandq_u16(y7, y12);
  y7 = vmvnq_s16(y7);
  y5 = vandq_s16(y7, y5);
  y12 = veorq_u16(y1, y5);
  // DONE MOD3
  vst1q_u16(688 + r->coeffs, y11);
  vst1q_u16(696 + r->coeffs, y12);
  r->coeffs[701] = 0;
  r->coeffs[702] = 0;
  r->coeffs[703] = 0;
}
