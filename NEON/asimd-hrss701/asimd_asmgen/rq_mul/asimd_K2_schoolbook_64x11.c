#include <arm_neon.h>

#define N 704

typedef struct Poly
{
    int16_t coeffs[N];
} poly;

int K2_schoolbook_64x11(poly *r, poly *a, poly *b)
{

    int16x8_t y0, y1, y2, y3, y4, y5, y6, y7, y8, y9, y10, y11, y12, y13, y14, y15;
    int16x8_t y16, y17, y18, y19, y20, y21, y22, y23, y24, y25, y26, y27, y28, y29, y30, y31;

    for (int i = 0; i < 4; i++)
    {
        y0 = vld1q_s16(0 + a->coeffs);
        y6 = vld1q_s16(0 + b->coeffs);
        y16 = vld1q_s16(8 + a->coeffs);
        y22 = vld1q_s16(8 + b->coeffs);
        y1 = vld1q_s16(16 + a->coeffs);
        y7 = vld1q_s16(16 + b->coeffs);
        y17 = vld1q_s16(24 + a->coeffs);
        y23 = vld1q_s16(24 + b->coeffs);
        y2 = vld1q_s16(32 + a->coeffs);
        y8 = vld1q_s16(32 + b->coeffs);
        y18 = vld1q_s16(40 + a->coeffs);
        y24 = vld1q_s16(40 + b->coeffs);
        y3 = vld1q_s16(48 + a->coeffs);
        y9 = vld1q_s16(48 + b->coeffs);
        y19 = vld1q_s16(56 + a->coeffs);
        y25 = vld1q_s16(56 + b->coeffs);
        y4 = vld1q_s16(64 + a->coeffs);
        y10 = vld1q_s16(64 + b->coeffs);
        y20 = vld1q_s16(72 + a->coeffs);
        y26 = vld1q_s16(72 + b->coeffs);
        y5 = vld1q_s16(80 + a->coeffs);
        y11 = vld1q_s16(80 + b->coeffs);
        y21 = vld1q_s16(88 + a->coeffs);
        y27 = vld1q_s16(88 + b->coeffs);
        y12 = vmulq_s16(y0, y6);
        y28 = vmulq_s16(y16, y22);
        vst1q_s16(0 + r->coeffs, y12);
        vst1q_s16(8 + r->coeffs, y28);
        y13 = vmulq_s16(y0, y7);
        y29 = vmulq_s16(y16, y23);
        y13 = vmlaq_s16(y13, y1, y6);
        y29 = vmlaq_s16(y29, y17, y22);
        vst1q_s16(16 + r->coeffs, y13);
        vst1q_s16(24 + r->coeffs, y29);
        y12 = vmulq_s16(y0, y8);
        y28 = vmulq_s16(y16, y24);
        y12 = vmlaq_s16(y12, y1, y7);
        y28 = vmlaq_s16(y28, y17, y23);
        y12 = vmlaq_s16(y12, y2, y6);
        y28 = vmlaq_s16(y28, y18, y22);
        vst1q_s16(32 + r->coeffs, y12);
        vst1q_s16(40 + r->coeffs, y28);
        y13 = vmulq_s16(y0, y9);
        y29 = vmulq_s16(y16, y25);
        y13 = vmlaq_s16(y13, y1, y8);
        y29 = vmlaq_s16(y29, y17, y24);
        y13 = vmlaq_s16(y13, y2, y7);
        y29 = vmlaq_s16(y29, y18, y23);
        y13 = vmlaq_s16(y13, y3, y6);
        y29 = vmlaq_s16(y29, y19, y22);
        vst1q_s16(48 + r->coeffs, y13);
        vst1q_s16(56 + r->coeffs, y29);
        y12 = vmulq_s16(y0, y10);
        y28 = vmulq_s16(y16, y26);
        y12 = vmlaq_s16(y12, y1, y9);
        y28 = vmlaq_s16(y28, y17, y25);
        y12 = vmlaq_s16(y12, y2, y8);
        y28 = vmlaq_s16(y28, y18, y24);
        y12 = vmlaq_s16(y12, y3, y7);
        y28 = vmlaq_s16(y28, y19, y23);
        y12 = vmlaq_s16(y12, y4, y6);
        y28 = vmlaq_s16(y28, y20, y22);
        vst1q_s16(64 + r->coeffs, y12);
        vst1q_s16(72 + r->coeffs, y28);
        y13 = vmulq_s16(y0, y11);
        y29 = vmulq_s16(y16, y27);
        y13 = vmlaq_s16(y13, y1, y10);
        y29 = vmlaq_s16(y29, y17, y26);
        y13 = vmlaq_s16(y13, y2, y9);
        y29 = vmlaq_s16(y29, y18, y25);
        y13 = vmlaq_s16(y13, y3, y8);
        y29 = vmlaq_s16(y29, y19, y24);
        y13 = vmlaq_s16(y13, y4, y7);
        y29 = vmlaq_s16(y29, y20, y23);
        y13 = vmlaq_s16(y13, y5, y6);
        y29 = vmlaq_s16(y29, y21, y22);
        vst1q_s16(80 + r->coeffs, y13);
        vst1q_s16(88 + r->coeffs, y29);
        y12 = vmulq_s16(y1, y11);
        y28 = vmulq_s16(y17, y27);
        y12 = vmlaq_s16(y12, y2, y10);
        y28 = vmlaq_s16(y28, y18, y26);
        y12 = vmlaq_s16(y12, y3, y9);
        y28 = vmlaq_s16(y28, y19, y25);
        y12 = vmlaq_s16(y12, y4, y8);
        y28 = vmlaq_s16(y28, y20, y24);
        y12 = vmlaq_s16(y12, y5, y7);
        y28 = vmlaq_s16(y28, y21, y23);
        vst1q_s16(96 + r->coeffs, y12);
        vst1q_s16(104 + r->coeffs, y28);
        y13 = vmulq_s16(y2, y11);
        y29 = vmulq_s16(y18, y27);
        y13 = vmlaq_s16(y13, y3, y10);
        y29 = vmlaq_s16(y29, y19, y26);
        y13 = vmlaq_s16(y13, y4, y9);
        y29 = vmlaq_s16(y29, y20, y25);
        y13 = vmlaq_s16(y13, y5, y8);
        y29 = vmlaq_s16(y29, y21, y24);
        vst1q_s16(112 + r->coeffs, y13);
        vst1q_s16(120 + r->coeffs, y29);
        y12 = vmulq_s16(y3, y11);
        y28 = vmulq_s16(y19, y27);
        y12 = vmlaq_s16(y12, y4, y10);
        y28 = vmlaq_s16(y28, y20, y26);
        y12 = vmlaq_s16(y12, y5, y9);
        y28 = vmlaq_s16(y28, y21, y25);
        vst1q_s16(128 + r->coeffs, y12);
        vst1q_s16(136 + r->coeffs, y28);
        y13 = vmulq_s16(y4, y11);
        y29 = vmulq_s16(y20, y27);
        y13 = vmlaq_s16(y13, y5, y10);
        y29 = vmlaq_s16(y29, y21, y26);
        vst1q_s16(144 + r->coeffs, y13);
        vst1q_s16(152 + r->coeffs, y29);
        y12 = vmulq_s16(y5, y11);
        y28 = vmulq_s16(y21, y27);
        vst1q_s16(160 + r->coeffs, y12);
        vst1q_s16(168 + r->coeffs, y28);
        y0 = vld1q_s16(96 + a->coeffs);
        y6 = vld1q_s16(96 + b->coeffs);
        y16 = vld1q_s16(104 + a->coeffs);
        y22 = vld1q_s16(104 + b->coeffs);
        y1 = vld1q_s16(112 + a->coeffs);
        y7 = vld1q_s16(112 + b->coeffs);
        y17 = vld1q_s16(120 + a->coeffs);
        y23 = vld1q_s16(120 + b->coeffs);
        y2 = vld1q_s16(128 + a->coeffs);
        y8 = vld1q_s16(128 + b->coeffs);
        y18 = vld1q_s16(136 + a->coeffs);
        y24 = vld1q_s16(136 + b->coeffs);
        y3 = vld1q_s16(144 + a->coeffs);
        y9 = vld1q_s16(144 + b->coeffs);
        y19 = vld1q_s16(152 + a->coeffs);
        y25 = vld1q_s16(152 + b->coeffs);
        y4 = vld1q_s16(160 + a->coeffs);
        y10 = vld1q_s16(160 + b->coeffs);
        y20 = vld1q_s16(168 + a->coeffs);
        y26 = vld1q_s16(168 + b->coeffs);
        y12 = vmulq_s16(y0, y6);
        y28 = vmulq_s16(y16, y22);
        vst1q_s16(192 + r->coeffs, y12);
        vst1q_s16(200 + r->coeffs, y28);
        y13 = vmulq_s16(y0, y7);
        y29 = vmulq_s16(y16, y23);
        y13 = vmlaq_s16(y13, y1, y6);
        y29 = vmlaq_s16(y29, y17, y22);
        vst1q_s16(208 + r->coeffs, y13);
        vst1q_s16(216 + r->coeffs, y29);
        y12 = vmulq_s16(y0, y8);
        y28 = vmulq_s16(y16, y24);
        y12 = vmlaq_s16(y12, y1, y7);
        y28 = vmlaq_s16(y28, y17, y23);
        y12 = vmlaq_s16(y12, y2, y6);
        y28 = vmlaq_s16(y28, y18, y22);
        vst1q_s16(224 + r->coeffs, y12);
        vst1q_s16(232 + r->coeffs, y28);
        y13 = vmulq_s16(y0, y9);
        y29 = vmulq_s16(y16, y25);
        y13 = vmlaq_s16(y13, y1, y8);
        y29 = vmlaq_s16(y29, y17, y24);
        y13 = vmlaq_s16(y13, y2, y7);
        y29 = vmlaq_s16(y29, y18, y23);
        y13 = vmlaq_s16(y13, y3, y6);
        y29 = vmlaq_s16(y29, y19, y22);
        vst1q_s16(240 + r->coeffs, y13);
        vst1q_s16(248 + r->coeffs, y29);
        y12 = vmulq_s16(y0, y10);
        y28 = vmulq_s16(y16, y26);
        y12 = vmlaq_s16(y12, y1, y9);
        y28 = vmlaq_s16(y28, y17, y25);
        y12 = vmlaq_s16(y12, y2, y8);
        y28 = vmlaq_s16(y28, y18, y24);
        y12 = vmlaq_s16(y12, y3, y7);
        y28 = vmlaq_s16(y28, y19, y23);
        y12 = vmlaq_s16(y12, y4, y6);
        y28 = vmlaq_s16(y28, y20, y22);
        vst1q_s16(256 + r->coeffs, y12);
        vst1q_s16(264 + r->coeffs, y28);
        y13 = vmulq_s16(y1, y10);
        y29 = vmulq_s16(y17, y26);
        y13 = vmlaq_s16(y13, y2, y9);
        y29 = vmlaq_s16(y29, y18, y25);
        y13 = vmlaq_s16(y13, y3, y8);
        y29 = vmlaq_s16(y29, y19, y24);
        y13 = vmlaq_s16(y13, y4, y7);
        y29 = vmlaq_s16(y29, y20, y23);
        vst1q_s16(272 + r->coeffs, y13);
        vst1q_s16(280 + r->coeffs, y29);
        y12 = vmulq_s16(y2, y10);
        y28 = vmulq_s16(y18, y26);
        y12 = vmlaq_s16(y12, y3, y9);
        y28 = vmlaq_s16(y28, y19, y25);
        y12 = vmlaq_s16(y12, y4, y8);
        y28 = vmlaq_s16(y28, y20, y24);
        vst1q_s16(288 + r->coeffs, y12);
        vst1q_s16(296 + r->coeffs, y28);
        y13 = vmulq_s16(y3, y10);
        y29 = vmulq_s16(y19, y26);
        y13 = vmlaq_s16(y13, y4, y9);
        y29 = vmlaq_s16(y29, y20, y25);
        vst1q_s16(304 + r->coeffs, y13);
        vst1q_s16(312 + r->coeffs, y29);
        y12 = vmulq_s16(y4, y10);
        y28 = vmulq_s16(y20, y26);
        vst1q_s16(320 + r->coeffs, y12);
        vst1q_s16(328 + r->coeffs, y28);
        y12 = vld1q_s16(0 + a->coeffs);
        y0 = vaddq_s16(y12, y0);
        y12 = vld1q_s16(0 + b->coeffs);
        y6 = vaddq_s16(y12, y6);
        y28 = vld1q_s16(8 + a->coeffs);
        y16 = vaddq_s16(y28, y16);
        y28 = vld1q_s16(8 + b->coeffs);
        y22 = vaddq_s16(y28, y22);
        y12 = vld1q_s16(16 + a->coeffs);
        y1 = vaddq_s16(y12, y1);
        y12 = vld1q_s16(16 + b->coeffs);
        y7 = vaddq_s16(y12, y7);
        y28 = vld1q_s16(24 + a->coeffs);
        y17 = vaddq_s16(y28, y17);
        y28 = vld1q_s16(24 + b->coeffs);
        y23 = vaddq_s16(y28, y23);
        y12 = vld1q_s16(32 + a->coeffs);
        y2 = vaddq_s16(y12, y2);
        y12 = vld1q_s16(32 + b->coeffs);
        y8 = vaddq_s16(y12, y8);
        y28 = vld1q_s16(40 + a->coeffs);
        y18 = vaddq_s16(y28, y18);
        y28 = vld1q_s16(40 + b->coeffs);
        y24 = vaddq_s16(y28, y24);
        y12 = vld1q_s16(48 + a->coeffs);
        y3 = vaddq_s16(y12, y3);
        y12 = vld1q_s16(48 + b->coeffs);
        y9 = vaddq_s16(y12, y9);
        y28 = vld1q_s16(56 + a->coeffs);
        y19 = vaddq_s16(y28, y19);
        y28 = vld1q_s16(56 + b->coeffs);
        y25 = vaddq_s16(y28, y25);
        y12 = vld1q_s16(64 + a->coeffs);
        y4 = vaddq_s16(y12, y4);
        y12 = vld1q_s16(64 + b->coeffs);
        y10 = vaddq_s16(y12, y10);
        y28 = vld1q_s16(72 + a->coeffs);
        y20 = vaddq_s16(y28, y20);
        y28 = vld1q_s16(72 + b->coeffs);
        y26 = vaddq_s16(y28, y26);
        y12 = vmulq_s16(y0, y11);
        y28 = vmulq_s16(y16, y27);
        y12 = vmlaq_s16(y12, y1, y10);
        y28 = vmlaq_s16(y28, y17, y26);
        y12 = vmlaq_s16(y12, y2, y9);
        y28 = vmlaq_s16(y28, y18, y25);
        y12 = vmlaq_s16(y12, y3, y8);
        y28 = vmlaq_s16(y28, y19, y24);
        y12 = vmlaq_s16(y12, y4, y7);
        y28 = vmlaq_s16(y28, y20, y23);
        y12 = vmlaq_s16(y12, y5, y6);
        y28 = vmlaq_s16(y28, y21, y22);
        y12 = vsubq_s16(y12, vld1q_s16(80 + r->coeffs));
        y12 = vsubq_s16(y12, vld1q_s16(272 + r->coeffs));
        vst1q_s16(176 + r->coeffs, y12);
        y28 = vsubq_s16(y28, vld1q_s16(88 + r->coeffs));
        y28 = vsubq_s16(y28, vld1q_s16(280 + r->coeffs));
        vst1q_s16(184 + r->coeffs, y28);
        y12 = vmulq_s16(y5, y7);
        y28 = vmulq_s16(y21, y23);
        y13 = vmulq_s16(y5, y8);
        y29 = vmulq_s16(y21, y24);
        y14 = vmulq_s16(y5, y9);
        y30 = vmulq_s16(y21, y25);
        y15 = vmulq_s16(y5, y10);
        y31 = vmulq_s16(y21, y26);
        y12 = vmlaq_s16(y12, y1, y11);
        y28 = vmlaq_s16(y28, y17, y27);
        y12 = vmlaq_s16(y12, y2, y10);
        y28 = vmlaq_s16(y28, y18, y26);
        y12 = vmlaq_s16(y12, y3, y9);
        y28 = vmlaq_s16(y28, y19, y25);
        y12 = vmlaq_s16(y12, y4, y8);
        y28 = vmlaq_s16(y28, y20, y24);
        y13 = vmlaq_s16(y13, y2, y11);
        y29 = vmlaq_s16(y29, y18, y27);
        y13 = vmlaq_s16(y13, y3, y10);
        y29 = vmlaq_s16(y29, y19, y26);
        y13 = vmlaq_s16(y13, y4, y9);
        y29 = vmlaq_s16(y29, y20, y25);
        y14 = vmlaq_s16(y14, y3, y11);
        y30 = vmlaq_s16(y30, y19, y27);
        y14 = vmlaq_s16(y14, y4, y10);
        y30 = vmlaq_s16(y30, y20, y26);
        y15 = vmlaq_s16(y15, y4, y11);
        y31 = vmlaq_s16(y31, y20, y27);
        y11 = vmulq_s16(y0, y10);
        y27 = vmulq_s16(y16, y26);
        y11 = vmlaq_s16(y11, y1, y9);
        y27 = vmlaq_s16(y27, y17, y25);
        y11 = vmlaq_s16(y11, y2, y8);
        y27 = vmlaq_s16(y27, y18, y24);
        y11 = vmlaq_s16(y11, y3, y7);
        y27 = vmlaq_s16(y27, y19, y23);
        y11 = vmlaq_s16(y11, y4, y6);
        y27 = vmlaq_s16(y27, y20, y22);
        y10 = vmulq_s16(y0, y9);
        y26 = vmulq_s16(y16, y25);
        y10 = vmlaq_s16(y10, y1, y8);
        y26 = vmlaq_s16(y26, y17, y24);
        y10 = vmlaq_s16(y10, y2, y7);
        y26 = vmlaq_s16(y26, y18, y23);
        y10 = vmlaq_s16(y10, y3, y6);
        y26 = vmlaq_s16(y26, y19, y22);
        y9 = vmulq_s16(y0, y8);
        y25 = vmulq_s16(y16, y24);
        y9 = vmlaq_s16(y9, y1, y7);
        y25 = vmlaq_s16(y25, y17, y23);
        y9 = vmlaq_s16(y9, y2, y6);
        y25 = vmlaq_s16(y25, y18, y22);
        y8 = vmulq_s16(y0, y7);
        y24 = vmulq_s16(y16, y23);
        y8 = vmlaq_s16(y8, y1, y6);
        y24 = vmlaq_s16(y24, y17, y22);
        y7 = vmulq_s16(y0, y6);
        y23 = vmulq_s16(y16, y22);
        y0 = vld1q_s16(96 + r->coeffs);
        y16 = vld1q_s16(104 + r->coeffs);
        y0 = vsubq_s16(y0, vld1q_s16(192 + r->coeffs));
        y16 = vsubq_s16(y16, vld1q_s16(200 + r->coeffs));
        y6 = vsubq_s16(y12, y0);
        y22 = vsubq_s16(y22, y16);
        y6 = vsubq_s16(y6, vld1q_s16(288 + r->coeffs));
        y22 = vsubq_s16(y22, vld1q_s16(296 + r->coeffs));
        vst1q_s16(192 + r->coeffs, y6);
        vst1q_s16(200 + r->coeffs, y22);
        y0 = vaddq_s16(y7, y0);
        y16 = vaddq_s16(y16, y16);
        y0 = vsubq_s16(y0, vld1q_s16(0 + r->coeffs));
        y16 = vsubq_s16(y16, vld1q_s16(8 + r->coeffs));
        vst1q_s16(96 + r->coeffs, y0);
        vst1q_s16(104 + r->coeffs, y16);
        y1 = vld1q_s16(112 + r->coeffs);
        y17 = vld1q_s16(120 + r->coeffs);
        y1 = vsubq_s16(y1, vld1q_s16(208 + r->coeffs));
        y17 = vsubq_s16(y17, vld1q_s16(216 + r->coeffs));
        y7 = vsubq_s16(y13, y1);
        y23 = vsubq_s16(y23, y17);
        y7 = vsubq_s16(y7, vld1q_s16(304 + r->coeffs));
        y23 = vsubq_s16(y23, vld1q_s16(312 + r->coeffs));
        vst1q_s16(208 + r->coeffs, y7);
        vst1q_s16(216 + r->coeffs, y23);
        y1 = vaddq_s16(y8, y1);
        y17 = vaddq_s16(y17, y17);
        y1 = vsubq_s16(y1, vld1q_s16(16 + r->coeffs));
        y17 = vsubq_s16(y17, vld1q_s16(24 + r->coeffs));
        vst1q_s16(112 + r->coeffs, y1);
        vst1q_s16(120 + r->coeffs, y17);
        y2 = vld1q_s16(128 + r->coeffs);
        y18 = vld1q_s16(136 + r->coeffs);
        y2 = vsubq_s16(y2, vld1q_s16(224 + r->coeffs));
        y18 = vsubq_s16(y18, vld1q_s16(232 + r->coeffs));
        y8 = vsubq_s16(y14, y2);
        y24 = vsubq_s16(y24, y18);
        y8 = vsubq_s16(y8, vld1q_s16(320 + r->coeffs));
        y24 = vsubq_s16(y24, vld1q_s16(328 + r->coeffs));
        vst1q_s16(224 + r->coeffs, y8);
        vst1q_s16(232 + r->coeffs, y24);
        y2 = vaddq_s16(y9, y2);
        y18 = vaddq_s16(y18, y18);
        y2 = vsubq_s16(y2, vld1q_s16(32 + r->coeffs));
        y18 = vsubq_s16(y18, vld1q_s16(40 + r->coeffs));
        vst1q_s16(128 + r->coeffs, y2);
        vst1q_s16(136 + r->coeffs, y18);
        y3 = vld1q_s16(144 + r->coeffs);
        y19 = vld1q_s16(152 + r->coeffs);
        y3 = vsubq_s16(y3, vld1q_s16(240 + r->coeffs));
        y19 = vsubq_s16(y19, vld1q_s16(248 + r->coeffs));
        y9 = vsubq_s16(y15, y3);
        y25 = vsubq_s16(y25, y19);
        vst1q_s16(240 + r->coeffs, y9);
        vst1q_s16(248 + r->coeffs, y25);
        y3 = vaddq_s16(y10, y3);
        y19 = vaddq_s16(y19, y19);
        y3 = vsubq_s16(y3, vld1q_s16(48 + r->coeffs));
        y19 = vsubq_s16(y19, vld1q_s16(56 + r->coeffs));
        vst1q_s16(144 + r->coeffs, y3);
        vst1q_s16(152 + r->coeffs, y19);
        y4 = vld1q_s16(160 + r->coeffs);
        y20 = vld1q_s16(168 + r->coeffs);
        y4 = vsubq_s16(y4, vld1q_s16(256 + r->coeffs));
        y20 = vsubq_s16(y20, vld1q_s16(264 + r->coeffs));
        y4 = vaddq_s16(y11, y4);
        y20 = vaddq_s16(y20, y20);
        y4 = vsubq_s16(y4, vld1q_s16(64 + r->coeffs));
        y20 = vsubq_s16(y20, vld1q_s16(72 + r->coeffs));
        vst1q_s16(160 + r->coeffs, y4);
        vst1q_s16(168 + r->coeffs, y20);
    }
}

int main()
{
    return 0;
}